"use strict";(self.webpackChunkboilerplate_app=self.webpackChunkboilerplate_app||[]).push([[682],{4682:(e,t,r)=>{r.r(t),r.d(t,{GamePage:()=>k,default:()=>b});var n=r(1638),i=r(5043),s=r(4943),o=r(3978),l=r(4445),a=r(6698),d=r(7502),c=r(579);const p=e=>{var t,r;let{options:n,style:s,fit:o,transform:p,fit_ratio:u}=e;const m=(0,i.useRef)(),{ref:h,width:g=(null===(t=m.current)||void 0===t?void 0:t.width),height:f=(null===(r=m.current)||void 0===r?void 0:r.height)}=(0,a.A)(),v=(0,i.useMemo)((()=>{var e,t,r,i;return{...n,width:o?null!==(e=n.width)&&void 0!==e?e:g:n.width,height:o?u?(null!==(t=null!==(r=n.width)&&void 0!==r?r:g)&&void 0!==t?t:0)*u:null!==(i=n.height)&&void 0!==i?i:f:n.height}}),[n,g,f,o]);return(0,i.useEffect)((()=>{g&&f&&(m.current={width:g,height:f});const e=l.Q(v),t=h.current;if(t){const r=t.children[0];r&&r.remove(),p&&p(d.Ltv(e)),t.appendChild(e)}}),[h,v,g,f,p]),(0,c.jsx)("div",{style:s,ref:h},JSON.stringify({options_:n}))};var u=r(8639),m=r(8443);const h=function(e){let{gameEngine:t,showWireframe:r}=e;const n=(0,i.useMemo)((()=>({type:"FeatureCollection",features:t.map.features.map((e=>({type:"Feature",geometry:e.geometry,properties:{name:e.properties.name,style:(()=>{const r="".concat(e.id);if(t.from===r)return{fill:m.J.FROM_COUNTRY,stroke:m.J.FROM_COUNTRY};if(t.to===r)return{fill:m.J.TO_COUNTRY,stroke:m.J.TO_COUNTRY};if(t.guesses.map((e=>e.id)).includes(r)){const e=t.guesses.find((e=>e.id===r));return{stroke:"#00000090",fill:null!==e&&void 0!==e&&e.correct||null!==e&&void 0!==e&&e.mostly_correct?null!==e&&void 0!==e&&e.correct?"#00000090":"transparent":"#FF000020"}}return null})()}}))).filter((e=>null!==e.properties.style))})),[t.map,t.from,t.to,t.guesses]);return(0,c.jsx)("div",{children:(0,c.jsx)(p,{fit:!0,fit_ratio:.5,options:{marks:[r?u.QY(t.map,{stroke:"lightgray",fill:"none",strokeWidth:.1}):null,u.QY(n,{fill:e=>{var t;return null===(t=e.properties.style)||void 0===t?void 0:t.fill},stroke:e=>{var t;return null===(t=e.properties.style)||void 0===t?void 0:t.stroke}})],axis:!1,projection:{type:"mercator",domain:n}}})})};var g=r(983),f=r(2687),v=r(2615),y=r(7144),j=r(8469),x=r(4088),w=r(86);const _=function(e){let{gameEngine:t}=e;const{setGameEngine:r}=(0,n.A)(),i=(0,w.a)();return t.won?(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,c.jsx)("h2",{children:"Congrats ! \ud83e\udd73"}),(0,c.jsxs)("div",{children:["You found in ",t.won.attempt," attemps"," ",t.won.perfect?(0,c.jsx)("span",{children:"(This is the perfect score !)"}):(0,c.jsxs)("span",{children:["(perfect was ",t.all_shortest_path[0].length-2,")"]})]}),(0,c.jsx)("div",{style:{padding:"1em"},children:t.guesses.map((e=>(0,c.jsx)(j.A,{color:e.correct?"green":e.mostly_correct?"orange":"red",children:e.name},e.id)))}),(0,c.jsxs)("div",{style:{padding:"1em"},children:[(0,c.jsx)("h3",{children:"Possible paths :"}),t.all_shortest_path.map((e=>(0,c.jsx)("div",{children:e.map((e=>(0,o.q)(e,t.map))).join(" > ")},e.join("-"))))]}),(0,c.jsx)("div",{style:{padding:"1em"},children:(0,c.jsx)(y.Ay,{type:"primary",onClick:()=>{const e=(0,x.generatePathForGame)(i.selectedMap.map.features.map((e=>({id:"".concat(e.id),neighbors:e.properties.border_countries}))),i.range[0],i.range[1]);r(new s.d(t.map,e[0],e[e.length-1]))},children:"Start a new game"})})]}):null};const O=function(e){let{gameEngine:t,setGameEngine:r}=e;const[n,l]=i.useState(!1),a=(0,i.useMemo)((()=>t.map.features.map((e=>({value:e.properties.name,label:e.properties.name}))).filter((e=>!t.guesses.map((e=>e.name)).includes(e.value))).filter((e=>e.value!==(0,o.q)(t.from,t.map)&&e.value!==(0,o.q)(t.to,t.map)))),[t.map,t.guesses,t.to,t.from]),[d,p]=(0,i.useState)("");return(0,c.jsxs)("div",{children:[(0,c.jsxs)("h2",{children:["I want to go from"," ",(0,c.jsx)("span",{style:{fontWeight:"bold",fontSize:"1.2em",color:m.J.FROM_COUNTRY},children:(0,o.q)(t.from,t.map)})," ","to"," ",(0,c.jsx)("span",{style:{fontWeight:"bold",fontSize:"1.2em",color:m.J.TO_COUNTRY},children:(0,o.q)(t.to,t.map)})]}),(0,c.jsx)(h,{gameEngine:t,showWireframe:n||!!t.won}),t.won?(0,c.jsx)("div",{style:{marginTop:"1em"},children:(0,c.jsx)(_,{gameEngine:t})}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{padding:"1em"},children:(0,c.jsx)(g.A,{checked:n,onChange:e=>l(e.target.checked),children:"Show wireframe"})}),(0,c.jsx)("div",{style:{padding:"1em"},children:(0,c.jsx)(f.A,{style:{width:"100%"},value:d,onChange:p,options:a,filterOption:(e,t)=>-1!==(null===t||void 0===t?void 0:t.value.toLowerCase().indexOf(e.toLowerCase())),children:(0,c.jsx)(v.A.Search,{size:"large",placeholder:"Select a country, territory...",enterButton:(0,c.jsx)(y.Ay,{type:"primary",children:"Guess"}),disabled:a.map((e=>e.value)).includes(d),onSearch:e=>{var n;const i="".concat(null===(n=t.map.features.find((t=>t.properties.name===e)))||void 0===n?void 0:n.id);try{t.guess(i);const e=Object.assign({},t);Object.setPrototypeOf(e,s.d.prototype),r(e),p("")}catch(o){console.error(o)}}})})}),(0,c.jsx)("div",{style:{padding:"1em"},children:t.guesses.map((e=>(0,c.jsx)(j.A,{color:e.correct?"green":e.mostly_correct?"orange":"red",children:e.name},e.id)))})]})]})};var C=r(4272);function k(){const{gameEngine:e,setGameEngine:t}=(0,n.A)();return e?(0,c.jsx)(O,{gameEngine:e,setGameEngine:t}):(window.location.href=C.P8,console.error("No game engine found"),null)}const b=k},3978:(e,t)=>{t.q=function(e,t){var r,n;return null!==(n=null===(r=t.features.find((t=>t.id===e)))||void 0===r?void 0:r.properties.name)&&void 0!==n?n:null}}}]);
//# sourceMappingURL=682.2e61b6fa.chunk.js.map